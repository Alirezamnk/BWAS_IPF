# Brain-Wide Association Study

This repository contains scripts to perform Brain-Wide Association Study (BWAS) to find the association between brain imaging-derived phenotypes and with idiopathic pulmonary fibrosis genetic risk, as descibed in this paper: [A. R. Mohammadi-Nejad, R. J. Allen, L. Kraven, O. C. Leavy, R. G. Jenkins, D. Auer, L. V. Wain, S. N. Sotiropoulos, “Mapping brain endophenotypes associated with idiopathic pulmonary fibrosis genetic predisposition”, eBioMedicine, 2022][paper-eBioMed-link].

## Code Overview

Figures in our paper can be regenerated using the codes that has been assigned for each figure (Figures 2, 3, 4, and 5).

### Figure 2. Manhattan plot of the BWAS outcomes of 17 known IPF variants using UK Biobank imaging cohort (S=32,431)
A jupyter notebook has been provided to generate Figure 2 (`Figure_2.ipynb`). Inside the data folder, there are 17 files which each of them is assigned to each IPF genetic variant (`IPF_XX.txt`). The list of all the IPF genetic variants is available [here][IPF-variant-list].
These files are the output of the BWAS generated by PLINK v2.0. The dimensions of each file is the Number of IDPs (1,248) x 10. The columns are 'BETA', 'T_STAT', 'UNADJ', 'GC', 'BONF', 'HOLM', 'SIDAK_SS', 'SIDAK_SD', 'FDR_BH', and 'FDR_BY' respectively. You can find more information about each column in PLINK's website. The list of the IDPs is available [here][IDP-list]. By running this code, the results will be a figure like this:

![Figure_2_orig](https://github.com/Alirezamnk/BWAS_IPF/blob/main/global/Figure_2.png)

### Figure 3. The association of the DEPTOR IPF variant with brain IDPs
To generate Figure 3a, the user needs to run the jupyter notebook provided for this figure (`Figure_3.ipynb`). User should specify the IPF variant number by changing the `VAR` variable in line 12. Same as Figure 2, the data folder contains 17 files (`IPF_XX.txt`) which each of them contains the summary statistics of the BWAS for each single IPF variants. These files are exactly the same as the files that have been described in Figure 2. In addition, for each variant there is a file known as `coloc_XX.txt`. The `coloc_XX.txt` file is a vector and its dimension is the number of IDPs (1,248) x 1. The value in each row can take '1' or '4'. Here, '4' means that that IDP has been co-localised against IPF risk which has been described in Figure 4. In addition, the data folder of this figure contains another file known as `ind_type.txt`. This file shows each IDP is categorised in which group IDP. By running this code, the results will be a figure like this:

![Figure_3_orig](https://github.com/Alirezamnk/BWAS_IPF/blob/main/global/Figure_3a.png)

We can use the same code to generate the Manhattan plot of chromosome 17 IPF variant presented in Figure 3a of the paper.

### Figure 4. Co-localisation of the two most significantly associated IDPs with chromosome 8 (region around the DEPTOR gene), against IPF risk.

### Figure 5. Secondary analysis.

## Usage

## Requirements

<!-- References -->

[paper-eBioMed-link]: https://www.sciencedirect.com/science/article/pii/S2352396422005382
[IPF-variant-list]: https://github.com/Alirezamnk/BWAS_IPF/blob/main/global/IPF_variants.png
[IDP-list]: https://www.sciencedirect.com/science/article/pii/S2352396422005382
